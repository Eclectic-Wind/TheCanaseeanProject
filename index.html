<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Canasëean Project</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Garamond:wght@400&family=Inter:wght@400;700&family=Times+New+Roman&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="main-title">
      <span class="first-letter">T</span>he Canasëean Project
    </div>

    <nav>
      <div id="nav-links">
        <a href="#quick-info" class="nav-link" data-page="quick_info"
          >QUICK INFO</a
        >
        <a href="#documents" class="nav-link" data-page="documents"
          >DOCUMENTS</a
        >
        <a href="#wiki" class="nav-link" data-page="wiki">WIKI</a>
      </div>
    </nav>

    <div id="content-container"></div>

    <script>
      // --- DOM Element References ---
      const title = document.getElementById("main-title");
      const navLinksContainer = document.getElementById("nav-links");
      const navLinks = document.querySelectorAll(".nav-link");
      const contentContainer = document.getElementById("content-container");

      // --- Content Loading Function ---
      /**
       * Fetches and displays HTML content from a specified page file.
       * @param {string} pageName - The base name of the HTML file to load (e.g., 'quick_info').
       */
      async function loadContent(pageName) {
        // Indicate loading state
        contentContainer.classList.remove("visible"); // Hide old content
        contentContainer.innerHTML =
          '<p class="message loading-message">Loading...</p>';

        try {
          const url = `${pageName}.html`; // Construct the file URL
          const response = await fetch(url);

          // Check if the fetch was successful
          if (!response.ok) {
            throw new Error(
              `HTTP error! status: ${response.status} loading ${url}`
            );
          }

          // Get the HTML content
          const htmlContent = await response.text();

          // Short delay for smooth transition (allows fade-out)
          setTimeout(() => {
            contentContainer.innerHTML = htmlContent; // Inject new content
            contentContainer.classList.add("visible"); // Fade in new content

            // === Post-Load Setup ===
            // If the quick_info page was loaded, set up its internal links
            if (pageName === "quick_info") {
              setupInternalLinks();
            }
            // Add setup for other pages if needed (e.g., wiki)
          }, 150); // 150ms delay
        } catch (error) {
          console.error("Error loading content:", error);
          // Display an error message to the user
          contentContainer.innerHTML = `<p class="message error-message">Error loading content for '${pageName}'. Please check the file exists and the path is correct. (${error.message})</p>`;
          contentContainer.classList.add("visible");
        }
      }

      // --- Internal Link Handling (e.g., within quick_info.html) ---
      /**
       * Sets up click handlers for internal navigation links within loaded content.
       */
      function setupInternalLinks() {
        // Use event delegation on the container for efficiency
        contentContainer.addEventListener("click", function (event) {
          // Check if the clicked element is an internal link
          if (event.target.matches(".internal-link")) {
            event.preventDefault(); // Stop default link behavior
            const page = event.target.getAttribute("data-page"); // Get the target page name
            if (page) {
              loadContent(page); // Load the new content section
              // Update URL hash (optional, for basic history/bookmarking)
              // Note: This doesn't create true SPA routing
              // window.location.hash = event.target.getAttribute("href");
            }
          }
        });
      }

      // --- Page Load Initialization & Animation ---
      window.addEventListener("load", () => {
        // 1. Start title fade-in animation
        requestAnimationFrame(() => {
          title.classList.add("loaded");
        });

        // 2. After a delay, trigger title move/shrink, reveal nav, and load initial content
        setTimeout(() => {
          title.classList.add("moved"); // Trigger move/shrink animation
          navLinksContainer.classList.add("visible"); // Trigger nav fade-in

          // Load the 'quick_info' page by default when animations settle
          loadContent("quick_info");
        }, 1500); // 1.5 second delay (adjust as needed)
      });

      // --- Main Navigation Link Click Handling ---
      navLinks.forEach((link) => {
        link.addEventListener("click", (event) => {
          event.preventDefault(); // Prevent default anchor link behavior
          const page = link.getAttribute("data-page"); // Get the target page name
          if (page) {
            loadContent(page); // Load the content for the clicked section
            // Update URL hash (optional)
            // window.location.hash = link.getAttribute("href");
          }
        });
      });

      // --- Handle Hash on Initial Load (Optional - uncomment/adapt if needed) ---
      // Handles loading a specific section if the page URL includes a hash like #documents
      // window.addEventListener('load', () => {
      //    const currentHash = window.location.hash.substring(1); // Get hash without '#'
      //    const validPages = ['quick_info', 'documents', 'wiki'];
      //    // Check if hash is valid and NOT the default 'quick_info' (already loaded by animation)
      //    if (validPages.includes(currentHash) && currentHash !== 'quick_info') {
      //        // Need to wait for animations to finish before loading
      //        setTimeout(() => {
      //             loadContent(currentHash);
      //        }, 1800); // Delay slightly longer than title animation
      //    }
      // });
    </script>
  </body>
</html>
